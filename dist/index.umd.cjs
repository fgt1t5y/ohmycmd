(function(t,a){typeof exports=="object"&&typeof module<"u"?a(exports):typeof define=="function"&&define.amd?define(["exports"],a):(t=typeof globalThis<"u"?globalThis:t||self,a(t.Ohmycmd={}))})(this,function(t){"use strict";var I=Object.defineProperty;var k=(t,a,i)=>a in t?I(t,a,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[a]=i;var n=(t,a,i)=>k(t,typeof a!="symbol"?a+"":a,i);const a=h=>/^(\-|\+)?([0-9]+|Infinity)$/.test(h)?Number(h):NaN;class i{constructor(e){n(this,"pass",!1);n(this,"originCommand","");n(this,"arguments",[]);n(this,"resolvedValue",{});this.originCommand=e}setPassed(e){return this.pass=e,this}}class f{constructor(e,s){n(this,"label");n(this,"name");n(this,"optional",!0);n(this,"next");this.label=e==null?void 0:e.label,this.name=e==null?void 0:e.name,this.optional=(e==null?void 0:e.optional)??!0,this.next=s}toArray(){const e=[this];let s=this;if(!s.next)return e;for(;s&&!(s.next&&(e.push(s.next),s=s.next,!s.next)););return e}}class P extends f{constructor(e,s){super({label:e},s)}check(e){return e===this.label}value(e){return e}}class S extends f{constructor(s,r){super(s,r);n(this,"min");n(this,"max");this.min=s==null?void 0:s.min,this.max=s==null?void 0:s.max}check(s){const r=a(s);return!(!Number.isInteger(r)||this.min&&r<this.min||this.max&&r>this.max)}value(s){return parseInt(s)}}class v extends f{constructor(e,s){super(e,s)}check(){return!0}value(e){return e}}class b extends f{constructor(e,s){super(e,s)}check(e){return e==="true"||e==="false"}value(e){return e==="true"}}class A{constructor(e){n(this,"schemas");n(this,"commandPrefix");this.schemas={},this.commandPrefix=e==null?void 0:e.commandPrefix}_add(e,s){const r=s.toArray();let c=!1;for(let u=0;u<r.length;u++)if(r[u].optional){if(c)throw new Error("Optional schemas must place at tail of schema chain.");continue}else c=!0;Array.isArray(this.schemas[e])?this.schemas[e].push(s):this.schemas[e]=[s]}add(e,s){if((!s||s.length===0)&&!this.schemas[e]){this.schemas[e]=[];return}if(!Array.isArray(s))throw new Error("Argument `schemas` is not a array");s.forEach(r=>{this._add(e,r)})}remove(e){this.schemas[e]&&delete this.schemas[e]}clear(){this.schemas={}}parse(e){const s=new i(e);let r=e.trim();if(this.commandPrefix){if(!r.startsWith(this.commandPrefix))return s.setPassed(!1);r=r.slice(this.commandPrefix.length)}const c=r.split(" "),u=this.schemas[c[0]];if(!u)return s.setPassed(!1);if(u.length===0)return c.length>1?s.setPassed(!1):s.setPassed(!0);if(u.length>0&&c.length<2)return s.setPassed(!1);c.shift();let g=0;for(;g<u.length;g++){const o=u[g].toArray(),d=[],x={};let l=0;for(;l<c.length;l++){const m=o[l];if(!m)break;const y=m.check(c[l]);d.push(y),y&&m.name&&(x[m.name]=m.value(c[l]))}if(d.length===c.length&&d.length===o.length&&d.every(m=>m))return s.arguments=c,s.resolvedValue=x,s.setPassed(!0)}return s.setPassed(!1)}test(e){return this.parse(e).pass}execute(e,s){s.apply(null,Object.values(this.parse(e).resolvedValue))}}t.BoolSchema=b,t.Commander=A,t.IntegerSchema=S,t.StringSchema=v,t.Subcommand=P,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})});
